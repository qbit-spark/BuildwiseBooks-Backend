<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    <title>Payment Voucher</title>
    <style type="text/css">
        body { font-family: "Times New Roman", serif; font-size: 11px; margin: 15px; page-break-inside: avoid; }
        .header {
            padding: 15px;
            margin-bottom: 20px;
            text-align: center;
        }
        .govt-seal {
            display: inline-block;
            width: 80px;
            height: 80px;
            margin: 0 auto 10px;
            position: relative;
        }
        .govt-seal img {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }
        .republic-header {
            font-size: 14px;
            font-weight: bold;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin: 5px 0;
            color: #000;
        }
        .ministry-name {
            font-size: 12px;
            font-weight: bold;
            margin: 3px 0;
            color: #000;
        }
        .department-name {
            font-size: 11px;
            font-weight: normal;
            margin: 3px 0;
            color: #333;
        }
        .document-title {
            font-size: 16px;
            font-weight: bold;
            text-decoration: underline;
            margin: 15px 0 10px;
            color: #000;
        }
        .voucher-number {
            font-size: 12px;
            font-weight: bold;
            color: #000;
            margin: 5px 0;
        }
        .header-divider {
            width: 80%;
            height: 2px;
            background: #000;
            margin: 10px auto;
        }
        .details-grid { width: 100%; margin: 10px 0; }
        .details-grid td { padding: 4px; border: 1px solid #ddd; font-size: 10px; }
        .section-header { background: #f1f5f9; font-weight: bold; padding: 6px; }
        .beneficiaries-table { width: 100%; border-collapse: collapse; margin: 10px 0; }
        .beneficiaries-table th, .beneficiaries-table td {
            border: 1px solid #ddd;
            padding: 6px;
            text-align: left;
            font-size: 10px;
        }
        .beneficiaries-table th { background: #f1f5f9; font-weight: bold; }
        .amount-cell { text-align: right; font-family: monospace; }
        .totals-box {
            border: 2px solid #2563eb;
            padding: 10px;
            margin: 10px 0;
            width: 280px;
            float: right;
            font-size: 10px;
        }
        .total-row { margin: 3px 0; }
        .main-total {
            border-top: 2px solid #2563eb;
            padding-top: 8px;
            margin-top: 8px;
            font-weight: bold;
        }
        .authority-section {
            border: 1px solid #ddd;
            padding: 12px;
            margin: 15px 0 10px 0;
            background-color: #fafafa;
            font-size: 9px;
        }
        .authority-section div:first-child {
            font-weight: bold;
            font-size: 11px;
            margin-bottom: 8px;
        }
        .signatures {
            margin-top: 20px;
            display: table;
            width: 100%;
            table-layout: fixed;
        }
        .signature-row {
            display: table-row;
        }
        .signature-box {
            display: table-cell;
            width: 25%;
            padding: 10px 5px;
            text-align: center;
            vertical-align: top;
        }
        .signature-line {
            border-bottom: 1px solid #000;
            margin: 25px 0 8px 0;
            height: 20px;
        }
        .signature-name {
            font-weight: bold;
            color: #2563eb;
            font-size: 10px;
        }
        .signature-role {
            font-size: 9px;
            color: #666;
        }
        .signature-date {
            font-size: 9px;
            color: #333;
        }
        .unsigned {
            color: #999;
            font-style: italic;
        }
        .clear { clear: both; }
        .page-break { page-break-before: always; }

        /* Ensure content fits on one page */
        @media print {
            body { margin: 10px; font-size: 10px; }
            .header { padding: 10px; margin-bottom: 15px; }
            .govt-seal { width: 50px; height: 50px; }
            .republic-header { font-size: 12px; }
            .document-title { font-size: 14px; margin: 10px 0 8px; }
            .signature-line { margin: 20px 0 5px 0; height: 15px; }
            .authority-section { padding: 8px; margin: 10px 0 8px 0; }
            .totals-box { margin: 8px 0; padding: 8px; }
        }
    </style>
</head>
<body>
<div class="header">

    <!-- Republic Header -->
    <div class="republic-header">United Republic of Tanzania</div>

    <!-- Ministry/Department Name -->
    <div class="ministry-name" th:text="${organisationName}">Ministry/Department Name</div>

    <!-- Horizontal divider -->
    <div class="header-divider"></div>

    <!-- Document title -->
    <div class="document-title">PAYMENT VOUCHER</div>

    <!-- Voucher number -->
    <div class="voucher-number">
        Voucher No: <span th:text="${voucherNumber}">PROJ0001-VCH-25-001</span>
    </div>
</div>

<table class="details-grid">
    <tr>
        <td class="section-header" colspan="4">Voucher Information</td>
    </tr>
    <tr>
        <td><strong>Date:</strong></td>
        <td th:text="${voucherDate}">Date</td>
        <td><strong>Status:</strong></td>
        <td th:text="${status}">Status</td>
    </tr>
    <tr>
        <td><strong>Project:</strong></td>
        <td th:text="${projectName}">Project Name</td>
        <td><strong>Project Code:</strong></td>
        <td th:text="${projectCode}">Project Code</td>
    </tr>
    <tr>
        <td><strong>Account:</strong></td>
        <td th:text="${accountCode + ' - ' + accountName}">Account</td>
        <td><strong>Created By:</strong></td>
        <td th:text="${createdByName}">Creator</td>
    </tr>
</table>

<div th:if="${description}">
    <strong>Description:</strong>
    <p th:text="${description}">Description text</p>
</div>

<table class="beneficiaries-table">
    <thead>
    <tr>
        <th>Vendor</th>
        <th>Description</th>
        <th>Gross Amount</th>
        <th>Deductions</th>
        <th>Net Amount</th>
    </tr>
    </thead>
    <tbody>
    <tr th:each="beneficiary, stat : ${beneficiaries}">
        <td th:text="${beneficiary.vendor.name}">Vendor Name</td>
        <td th:text="${beneficiary.description}">Description</td>
        <td class="amount-cell" th:text="${#numbers.formatDecimal(beneficiary.amount, 0, 2)}">0.00</td>
        <td>
            <div th:each="deduction : ${beneficiary.deductions}" th:if="${beneficiary.deductions != null}">
                <span th:text="${deduction.deductName + ' (' + deduction.percentage + '%): ' + #numbers.formatDecimal(deduction.deductionAmount, 0, 2)}">Deduction</span>
            </div>
            <span th:if="${beneficiary.deductions == null or beneficiary.deductions.isEmpty()}">None</span>
        </td>
        <td class="amount-cell" th:text="${#numbers.formatDecimal(beneficiaryNetAmounts[stat.index], 0, 2)}">0.00</td>
    </tr>
    </tbody>
</table>

<div class="totals-box">
    <div class="total-row">
        <strong>Total Gross: </strong>
        <span th:text="${currency + ' ' + totalGrossAmount}">0.00</span>
    </div>
    <div class="total-row">
        <strong>Total Deductions: </strong>
        <span th:text="${currency + ' ' + totalDeductions}">0.00</span>
    </div>
    <div class="total-row main-total">
        <strong>Net Amount: </strong>
        <span th:text="${currency + ' ' + totalNetAmount}">0.00</span>
    </div>
    <div style="margin-top: 10px; font-size: 11px;">
        <strong>In Words:</strong>
        <div th:text="${amountInWords}">Amount in words</div>
    </div>
</div>

<div class="clear"></div>

<!-- Authority Section -->
<div class="authority-section">
    <div style="font-weight: bold; font-size: 14px; margin-bottom: 15px;">
        AUTHORITY:
    </div>
    <div style="font-size: 11px; line-height: 1.6; text-align: justify;">
        Certify that the above sum of <strong th:text="${currency + ' ' + totalNetAmount}">TZS 0.00</strong>
        (In words) <strong style="text-transform: uppercase;" th:text="${amountInWords}">AMOUNT IN WORDS</strong>
        is correctly payable to the above-named person and that the rates of payment/price(s) is/are in
        accordance with Regulations/the Terms of the Contract and the funds are available under the Sub-Vote
        and Item quoted above to meet this payment.
    </div>
</div>

<!-- Compact Signatures Section - 4 signatures in one row -->
<div class="signatures">
    <div class="signature-row">
        <div class="signature-box" th:each="signature : ${approvalSignatures}">
            <div><strong th:text="${signature.roleTitle}" style="font-size: 10px;">Role Title</strong></div>
            <div class="signature-line"></div>

            <!-- Show actual user name if signed, placeholder if not -->
            <div th:if="${signature.isSigned}" class="signature-name" th:text="${signature.userName}">User Name</div>
            <div th:if="${!signature.isSigned}" class="unsigned">_______________</div>

            <!-- Show role name -->
            <div class="signature-role" th:text="${signature.roleName}">Role Name</div>

            <!-- Show actual date if signed, placeholder if not -->
            <div th:if="${signature.isSigned}" class="signature-date">
                Date: <span th:text="${signature.signedDate}">Date</span>
            </div>
            <div th:if="${!signature.isSigned}" class="signature-date unsigned">
                Date: _______
            </div>
        </div>
    </div>
</div>

<div class="clear"></div>

<div style="margin-top: 40px; text-align: center; font-size: 10px; color: #666;">
    Generated on: <span th:text="${createdAt}">timestamp</span>
</div>
</body>
</html>